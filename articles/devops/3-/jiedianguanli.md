# 节点管理

针对互联网业务所需服务器数量多、难以管理的特点，iuap运维平台将所有服务器统一纳入管控，通过Web操作实现高效节点管理。主机管理提供了主机托管和容器管理功能。在这里用户可以创建自己的docker集群。不管是阿里云、青云、aws等IaaS云主机，还是物理机、内网虚拟机，都可以添加到私有集群里。镜像下载、代码构建和容器创建这一整套的解决方案也可以无缝地应用到私有集群中。

![](/articles/devops/3-/images/image9.png)

图 节点管理

## 增加节点

操作路径：首页->【系统管理】->【节点管理】->【增加节点】

 ![](/articles/devops/3-/images/image10.png)
   
图 增加节点

用户需要填写root用户的密码进行主机注册。可直接按"IP地址+端口号+节点前缀+密码"格式输入（中间用空格隔开），每条数据使用回车键换行；名称将自动组装，例如tomcat-172.20.1.1。增加完毕后，点击安装按钮进行安装。

若想查看节点的安装进度，可返回节点管理页面，点击查看正在安装的节点查看当前正在安装的节点信息。

【注意】用户请使用正确的节点前缀，便于对于多个主机节点的命令的同时下发。

## 安装中间件

如果安装时使用的全安装（install_standlone），则会将私有镜像仓库、容器管理、资源管理、应用监控等中间件自动安装。如果是集群（install_cluster）安装的则需要手动安装一些中间件，下面就讲一下集群安装中需要手动安装的过程。

操作路径：首页->【系统管理】->【节点管理】->【安装中间件】

如图选择预制脚本，将要安装的主机节点选择到右侧区，点击开始安装。系统预制的安装脚本分为：

```
1)	tomcat

2)	mysql

3)	资源池主控端

4)	添加到资源池

5)	docker-registry

6)	nginx

7)	redis-master

8)	redis-slave

9)	haproxy

10)	rabbitMQ

11)	ganglia单播

12)	ELK-Elasticsearch

13)	ELK-Logstash

14)	ELK-Kibana

15)	zookeeper

16)	ABTestingGateway

17)	FastDFS-Tracker

18)	FastDFS-Storage

19)	FastDFS-Client

20)	JDK
```

![](/articles/devops/3-/images/image11.png)
 
图 安装中间件

安装的信息将在页面下方的界面中显示出来。

## 命令下发

iuap运维平台通过部署SaltStack环境，可以在成千上万台服务器上做到批量执行命令，根据不同业务特性进行配置集中化管理、分发文件、采集服务器数据、操作系统基础及软件包管理等，SaltStack是运维人员提高工作效率、规范业务配置与操作的利器。iuap运维平台为用户提供了命令下发的功能。

操作路径：首页->【系统管理】->【节点管理】->【命令下发】

用户填写执行主机，名称能够根据正则表达式进行匹配。选择命令匹配规则和执行模块。用户输入要执行的命令。点击“执行命令”按钮进行执行。执行的信息在下侧的屏幕区域进行展示。

![](/articles/devops/3-/images/image12.png)

图 命令下发

## 配置管理

iuap运维平台统一自动化管理中间件的部署和配置，减少复杂环境下人工操作带来的重复性和不确定性，防止配置漂移。

操作路径：首页->【系统管理】->【节点管理】->【配置管理】

选择节点（主机），获取配置。用户可以通过该界面：



```
1)	浏览该主机的配置。

2)	修改该主机的配置，点击更新配置按钮进行更新该主机的配置。

3)	修改该主机的配置，选择不同的节点（主机）点击更新配置按钮将该配置更新到选择的节点上。
```



![](/articles/devops/3-/images/image13.png)

图 配置管理

## 集群管理

运维平台可以对主机进行分组管理和监控。

操作路径：首页->【系统管理】->【节点管理】->【集群管理】
 
 ![](/articles/devops/3-/images/image14.png)
 
图 集群管理

点击增加集群按钮，在弹出的增加集群界面中（如下图）填写相应的信息信息。


```

1)	集群名称：用户填写集群名称。如:tomcat集群V4

2)	集群id：只能由数字、字母和下划线或者中划线组成。

3)	集群类型：选择集群类型。集群类型定义了集群的默认显示图标。

4)	选择节点：节点即主机。将节点从左侧列表移动到右侧列表中。
```



填写完毕后，点击“增加集群”按钮，进行保存增加。

 ![](/articles/devops/3-/images/image15.png)
   
图 增加集群

修改集群：可修改集群中的节点及集群名称等信息；

点击查看监控可查看集群监控的机器，可实时掌握系统整体与应用服务的健康状态，以便提前发现问题和出现问题时尽快做出应对。如下图：

![](/articles/devops/3-/images/image16.png)

图 查看监控
